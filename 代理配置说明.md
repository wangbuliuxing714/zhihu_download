# 代理配置说明

## 🌐 系统代理设置

本工具已配置为**自动使用系统代理**，无需额外配置。

---

## ✅ 如何检查系统代理

### Windows系统

#### 方法1：通过设置检查
1. 打开"设置" → "网络和Internet" → "代理"
2. 查看"手动设置代理"部分
3. 如果开启了代理，会显示代理服务器地址和端口

#### 方法2：通过环境变量检查
打开PowerShell，输入：
```powershell
# 查看HTTP代理
$env:HTTP_PROXY
$env:HTTPS_PROXY

# 或者查看所有环境变量
Get-ChildItem Env: | Where-Object {$_.Name -like "*PROXY*"}
```

---

## 🔧 常见代理软件配置

### 1. Clash
- 默认代理地址：`http://127.0.0.1:7890`
- 确保Clash正在运行
- 确保"系统代理"已开启

### 2. V2Ray / V2RayN
- 默认代理地址：`http://127.0.0.1:10809`
- 确保V2Ray正在运行
- 确保"启用系统代理"已勾选

### 3. Shadowsocks
- 默认代理地址：`http://127.0.0.1:1080`
- 确保Shadowsocks正在运行
- 确保"启用系统代理"已勾选

### 4. Proxifier
- 会自动拦截所有网络请求
- 确保Proxifier正在运行
- 确保规则配置正确

---

## 🐛 常见问题

### 问题1：ProxyError - Unable to connect to proxy

**原因**：
- 代理软件未运行
- 代理端口配置错误
- 系统环境变量中配置了错误的代理

**解决方法**：

#### 方案A：启动代理软件
1. 打开你的代理软件（Clash/V2Ray等）
2. 确保代理软件正在运行
3. 确保"系统代理"已开启
4. 重新运行爬虫

#### 方案B：清除错误的代理配置
如果你不使用代理，但系统配置了错误的代理：

**临时清除（PowerShell）：**
```powershell
$env:HTTP_PROXY = ""
$env:HTTPS_PROXY = ""
$env:NO_PROXY = ""
```

**永久清除：**
1. 右键"此电脑" → "属性" → "高级系统设置"
2. 点击"环境变量"
3. 删除`HTTP_PROXY`、`HTTPS_PROXY`等变量
4. 重启电脑

#### 方案C：在代码中手动指定代理
如果需要手动指定代理，可以设置环境变量：

```powershell
# 设置代理（临时）
$env:HTTP_PROXY = "http://127.0.0.1:7890"
$env:HTTPS_PROXY = "http://127.0.0.1:7890"

# 然后运行程序
python run_gui.py
```

---

### 问题2：连接超时

**原因**：
- 代理服务器响应慢
- 网络不稳定
- 知乎服务器限流

**解决方法**：
1. 检查代理软件是否正常工作
2. 尝试切换代理节点
3. 等待一段时间后重试

---

### 问题3：403 Forbidden

**原因**：
- Cookie已过期
- 被知乎反爬虫检测
- IP被封禁

**解决方法**：
1. 重新获取Cookie
2. 更换代理节点
3. 等待一段时间后重试

---

## 🔍 如何测试代理是否正常

### 方法1：使用curl测试
```powershell
# 测试代理是否能访问知乎
curl -x http://127.0.0.1:7890 https://www.zhihu.com
```

### 方法2：使用Python测试
创建测试脚本`test_proxy.py`：
```python
import requests
import os

# 显示当前代理设置
print("HTTP_PROXY:", os.environ.get('HTTP_PROXY'))
print("HTTPS_PROXY:", os.environ.get('HTTPS_PROXY'))

# 测试连接
try:
    session = requests.Session()
    session.trust_env = True
    response = session.get('https://www.zhihu.com', timeout=10)
    print(f"连接成功！状态码: {response.status_code}")
except Exception as e:
    print(f"连接失败: {e}")
```

运行：
```powershell
python test_proxy.py
```

---

## 💡 推荐配置

### 如果你在国内
1. 使用Clash或V2Ray等代理软件
2. 确保代理软件正在运行
3. 开启"系统代理"模式
4. 直接运行本工具，无需额外配置

### 如果你在国外
1. 不需要代理
2. 如果系统配置了代理，请关闭或清除
3. 直接运行本工具

---

## 📞 仍然无法解决？

请提供以下信息：
1. 完整的错误信息
2. 你使用的代理软件名称和版本
3. 系统环境变量中的代理配置
4. 代理软件的运行状态截图

发送到：twaapot@gmail.com

